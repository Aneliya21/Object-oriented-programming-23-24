## Потоци
- представляват последователност от байтове, използвани за предаване или приемане на данни 
- потоците не предоставят произволен достъп до данните си, а само последователен, т.е можем да манипулираме данните само в реда, в който те пристигат от потока
- осъществяват връзка между програмата и входните/изходните устройства/програми
- програмистът трябва само да се научи как да взаимодейства с тях - подробностите за това как потокът взаимодейства с действителните устройства, към които е свързан, се оставят на средата или операционната система

## Видове потоци:

![hierarchy](https://upload.cppreference.com/mwiki/images/0/06/std-io-complete-inheritance.svg)

## Входни потоци

- използват се за съхраняване на входни данни от източник на данни, като например клавиатура, файл или мрежа
- например потребителят може да натисне клавиш на клавиатурата, докато програмата в момента не очаква никакъв вход
- вместо да се игнорира натискането на клавиша от потребителя, данните се поставят във входен поток, където ще чакат, докато програмата е готова за тях
- операторът за извличане (>>) се използва за взимане на стойността на потока и премахването й от него

- `std::cin` - **обект** от тип istream, свързан със стандартния вход (обикновено клавиатурата)

 ```cpp
#include <iostream>

int main()
{
	int a, b;
	std::cin >> a >> b; 

    char buff[10];
    std::cin >> buff; // чете до разделител, четецът остава преди разделителя
    std::cin.ignore(); // игнорира 1 символ - използваме, за да отидем след разделителя
    std::cin.getline(buff, 10); // чете цял ред, до брой байтове
    std::cin.getline(buff, 10, ':'); // чете до реазделител ':'

}
 ```

 ## Изходни потоци
 - използват се за съхраняване на изходни данни за конкретен потребител на данни, като например монитор, файл или принтер. 
 - когато се записват данни към изходно устройство, то може да не е готово да приеме тези данни
 - данните ще се намират в изходния поток, докато устройството не започне да ги консумира
- операторът за вмъкване (<<) се използва за въвеждане на стойности в потока

- `std::cout` - **обект** ostream, свързан със стандартния изход (обикновено монитора)

 ```cpp
#include <iostream>

int main()
{
	int a = 5;
    int b = 20;
	std::cout << a << b; 

    char buff[] = "abc";
    std::cout << buf;
}
 ```

 ## Работа с файлове
 - файл - последователност от байтове
 - можем да отворим поток за вход/изход към файл
 - работим по същия начин, както със std::cin/std::cout
```cpp
#include <iostream>
#include <fstream>

constexpr int BUFF_SIZE = 1024;
const char FILE_NAME[] = "data.txt";

int main()
{
	std::ifstream inFile(FILE_NAME);

	if (!inFile.is_open()) {
		std::cout << "Error opening file!" << std::endl;
		return -1;
	}
	
	while (!inFile.eof()) {
        // можем да прочетем целия ред/до разделител
		char buff[BUFF_SIZE];
		inFile.getline(buff, BUFF_SIZE);
		
        //алтернативно, можен=м да прочетем само един символ
        char c = inFile.get();

        //или
        int a, b;
        inFile >> a >> b;

		//обработваме прочетения ред
	}

	
	inFile.close();
}
```

 ```c++
#include <iostream>
#include <fstream>

const char FILE_NAME[] = "data.txt";

int main()
{
	std::ofstream outFile(FILE_NAME);  

	if (!outFile.is_open()) {
		std::cout << "Error opening file!" << std::endl;
		return -1;
	}
	
	int a = 5;
    char b[] = "str";

	outFile << a << " " << b << std::endl;

    //алтернативно, можем да запишем 1 символ
    outFile.put(b[0]);

	outFile.close();
}
 ```

## Позициониране във файл
### **get указател** - указател на istream/ifstream, реферира следващия елемент, който ще се прочете от потока
- **tellg()** - връща позицития на get указателя
- **seekg(offset, direction)** - премества get-указателят на конкретна позцития, където

    -> **offset** - отместването от direction (цяло число)
    
    -> **direction** - едно от следните:
    1. ios::beg - началото на файла
    2. ios::cur - текущата позиция във файла
    3. ios::end - края на файла

 - **seekg(streampos idx)** - премества get-указателя на позция idx (започвайки от 0)
### **put указател** - указател на ostream/ofstream, реферира мястото в паметта, където ще се запише следващият елемент

 - **tellp()** - wръща позицития на put указателя

 - **seekp(offset, direction)** - премества put-указателя на конкретна позцития
 - **seekp(streampos idx)** - премества put-указателят на позция idx

## Състояния на потока
| Флаг      | Значение                                                                                    |
|-----------|---------------------------------------------------------------------------------------------|
| goodbit   | Всичко е наред                                                                             |
| badbit    | Възникнала е някаква фатална грешка (например има проблем с буфера на потока) |
| eofbit    | Потокът е достигнал края на файл                                                              |
| failbit   | Възникнала е грешка, която не е фатална (например програмата се е опитала да прочете след края на файл или потребителят е въвел букви, когато програмата очаква цяло число) |

| Функция | Описание                                                                       |
|---------|--------------------------------------------------------------------------------|
| good()  | Връща true, ако goodbit е зададен (потокът е в добро състояние)           |
| bad()   | Връща true, ако badbit е зададен (възникнала е фатална грешка)                |
| eof()   | Връща true, ако eofbit е зададен (потокът е в края на файл)                   |
| fail()  | Връща true, ако failbit е зададен (възникнала е не фатална грешка)             |
| clear() | Изчиства всички флагове и възстановява потока до състояние goodbit            |


## Задачи
**Задача 1**: Напишете програма, която отпечатва собствения си код.

**Задача 2**: Напишете функция, която приема име на съществуващ файл и име и копира съдържанието на същестуващия файл в нов файл.
